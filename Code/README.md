
**Contributors**: _Jonathan Colmer, Zoe Mitchell, and Nick Silvis_.


## Project Description


Between 2017 and 2023, a sizable fraction (up to 30%) of the EPA's roughly 1,000 PM2.5 monitors produced upward-biased readings. Given that ground-level PM2.5 readings are used as a benchmark to verify satellite data, these inaccurate readings have possible consequences beyond the EPA's datasets. This project seeks to understand the extent and implications of this miscalibration by comparing the EPA's original (incorrect) and updated (corrected) datasets and examining them against satellite data.


## Overview

The code in this replication package constrcts the analysis file from two main data sources (the EPA's PM2.5 monitor data and hybrid PM2.5 satellite data (SatPM2.5 data V6.GL.02.04) from the Washington University in St. Louis's Atmospheric Composition Analysis Group) using R. Five files run all of the code to generate the data for the ten figures and two tables in the paper. The replicator should expect the code to run for about 5 minutes.

## Data Availability and Provenance Statements

- [ ] This paper does not involve analysis of external data (i.e., no data are used or the only data are generated by the authors via simulation in their code).

### Statement about Rights

- [x] I certify that the author(s) of the manuscript have legitimate access to and permission to use the data used in this manuscript. 
- [x] I certify that the author(s) of the manuscript have documented permission to redistribute/publish the data contained within this replication package. Appropriate permission are documented in the [LICENSE.txt](LICENSE.txt) file.


### License for Data

The SatPM2.5 data V6.GL.02.04 is licensed under a [Creative Commons/CC BY 4.0 license](https://example.com).

### Summary of Availability

- [x] All data **are** publicly available.
- [ ] Some data **cannot be made** publicly available.
- [ ] **No data can be made** publicly available.

- [ ] Confidential data used in this paper and not provided as part of the public replication package will be preserved for ___ years after publication, in accordance with journal policies. 

### Details on Each Data Source

| Data.Name  | Data.Files | Location | Provided | Citation |
| -- | -- | -- | -- | -- | 
| “EPA PM2.5 Monitors Data” | daily_88101_2017.csv; daily_88101_2018; daily_88101_2019.csv; daily_88101_2020.csv; daily_88101_2021.csv; daily_88101_2022.csv| Data/ | TRUE | EPA (2025) |
| “SatPM2.5 Data V5.GL.05.02” | V5GL04.HybridPM25.NorthAmerica.201701-201712.rda; V5GL04.HybridPM25.NorthAmerica.201801-201812.rda; V5GL04.HybridPM25.NorthAmerica.201901-201912.rda; V5GL04.HybridPM25.NorthAmerica.202001-202012.rda; V5GL04.HybridPM25.NorthAmerica.202101-202112.rda; V5GL04.HybridPM25.NorthAmerica.202201-202212.rda | Data/ | TRUE | van Donkelaar et al. (2024) |  


**EPA PM2.5 Monitors Data**

Data on the Environmental Protection Agency (EPA)'s PM2.5 ground monitors were obtained from the Environmental Protection Agency (EPA, 2025). Data can be downloaded from https://aqs.epa.gov/aqsweb/airdata/download_files.html#AQI, under "Particulates." The data are in the public domain.

Datafiles:

 `daily_88101_2017.csv`; `daily_88101_2018`; `daily_88101_2019.csv`; `daily_88101_2020.csv`; `daily_88101_2021.csv`; `daily_88101_2022.csv`

**SatPM2.5 Data V5.GL.05.02**

Hybrid satellite data (SatPM2.5 Data V5.GL.05.02) were obtained from the Washington University in St. Louis's Atmospheric Analysis Composition Group. Data can be downloaded from https://sites.wustl.edu/acag/datasets/surface-pm2-5/#V5.GL.05.02, under SatPM2.5 data V5.GL.05.02. The data are in the public domain.

Datafiles: 

`V5GL04.HybridPM25.NorthAmerica.201701-201712.rda`; `V5GL04.HybridPM25.NorthAmerica.201801-201812.rda`; `V5GL04.HybridPM25.NorthAmerica.201901-201912.rda`; `V5GL04.HybridPM25.NorthAmerica.202001-202012.rda`; `V5GL04.HybridPM25.NorthAmerica.202101-202112.rda`; `V5GL04.HybridPM25.NorthAmerica.202201-202212.rda`


## Dataset List


| Data file                                  | Source             | Notes                                                                                               | Provided |
|--------------------------------------------|--------------------|-----------------------------------------------------------------------------------------------------|----------|
| `monitor_all`             | Derived    | All EPA monitor data for 2017–2023, appended; includes duplicate rows for impacted monitors with original and updated method codes | Yes      |
| `impacted_monitors`       | Derived            | Subset of `monitor_all` containing only monitors with originally incorrect data and their updates  | Yes      |
| `original_monitor_data_impacted` | Derived      | Original (incorrect) data for impacted monitors only                                               | Yes      |
| `updated_monitor_data_impacted`  | Derived      | Updated (corrected) data for impacted monitors only                                                | Yes      |
| `monitor_combined`        | Derived            | Derived from `monitor_all`; distinguishes "original" vs "updated" using `method_type` column       | Yes      |
| `monitor_satellite_long_impacted` | Derived        | `impacted_monitors` overlaid with satellite data                                                   | Yes      |
| `monitor_satellite_long_alldata` | Derived         | `monitor_combined` overlaid with satellite data                                                    | Yes      |



## Computational Requirements

The data processing for this replication package is not computationally intensive and can be run on a typical 16 GB RAM laptop.

### Software Requirements

- [x] The replication package contains one or more programs to install all dependencies and set up the necessary directory structure. [HIGHLY RECOMMENDED]

- R (version 4.5.0, 2025-04-11)  
  - `pacman` (0.5.1)  
  - `ggplot2` (3.5.2)  
  - `dplyr` (1.1.4)  
  - `tidyr` (1.3.1)  
  - `tibble` (3.2.1)  
  - `raster` (3.6.32)  
  - `sp` (2.2.0)  
  - `sf` (1.0-21)  
  - `tigris` (2.2.1)  
  - `cowplot` (1.1.3)  
  - `gtable` (0.3.6)  
  - `stargazer` (5.2.3)  
  - `smoothr` (1.0.1)  
  - `janitor` (2.2.1)  
  - `readr` (2.1.5)  
  - `units` (0.8.7)  
  - `scales` (1.4.0)

All required packages are installed by running 00_setup.R.

### Controlled Randomness

- [ ] Random seed is set at line _____ of program ______
- [x] No Pseudo random generator is used in the analysis described here.

### Memory, Runtime, Storage Requirements

#### Summary

Approximate time needed to reproduce the analyses on a standard (2025) desktop machine:

- [x] <10 minutes
- [ ] 10-60 minutes
- [ ] 1-2 hours
- [ ] 2-8 hours
- [ ] 8-24 hours
- [ ] 1-3 days
- [ ] 3-14 days
- [ ] > 14 days

Approximate storage space needed:

- [] < 25 MBytes
- [ ] 25 MB - 250 MB
- [ ] 250 MB - 2 GB
- [x] 2 GB - 25 GB
- [ ] 25 GB - 250 GB
- [ ] > 250 GB

- [ ] Not feasible to run on a desktop machine, as described below.

#### Details

The code was last run on an **Apple M1-based laptop with macOS version 12.7.6 (21H1320) and 110.11 GB of free disk space**.

## Description of Programs/Code


- `00_setup.R` loads the required packages for the operations in scripts 01-04b.
- `01_load_data.R` loads all of the neccessary PM2.5 ground monitors data from EPA (2025) and hybrid satellite data from van Donkelaar et al. (2024). The script appednds the individual yearly EPA datasets to form the unified 2017-2023 dataset monitors_all, and the individual yearly satellite datasets  to form the unified 2017-2022 dataset sat_list.
- `02a_clean_impactedonly.R` derives monitor_data_impacted, which contains data on the impacted (originalyl incorrect) monitors only, by filtering on the column method_code. The script then overlays monitor_data_impacted with the satellite data in sat_list to generate monitor_satellite_long_impacted.
- `02b_clean_alldata.R` generates data frame 
monitor_data_combined, which contains data for all of the monitors (impacted and non-impacted), with column method_type to distinguish between "original" (non-corrected) and "updated" (corrected) data. It then overlays monitor_data_combined with the satellite data from sat_list to create monitor_satellite_long_alldata.
- `03a_figures_impactedonly.R` produces the main figures for the analysis of the impacted monitors.
- `03b_figures_alldata.R` produces the main figures for the analysis of the full dataset.
- `04a_regressions_impactedonly.R` performs the regression analysis of the impacted monitors.
- `04b_regressions_alldata.R` performs the regerssion analysis regression of the entire dataset.


## Instructions to Replicators

- Edit line 24 of `00_setup.R` to adjust the default path.
- Run scripts 00-04b (in order) to complete the full analysis.
- Download the data files referenced above. Each should be stored in the prepared subdirectories of `data/`, in the format that you download them in. 


## List of Tables and Programs


The provided code reproduces:

- [ ] All numbers provided in text in the paper
- [ ] All tables and figures in the paper
- [ ] Selected tables and figures in the paper, as explained and justified below.


| Figure/Table # | Program                          | Line Number | Output file                              | Note                                                                                    |
| -------------- | -------------------------------- | ----------- | ---------------------------------------- | --------------------------------------------------------------------------------------- |
| Figure 1       | 03a\_figures\_impactedonly.R     | 12          | density\_plot\_99\_impacted.png          | Distribution of PM2.5 (trimmed at 99th percentile) for impacted monitors                |
| Figure 2       | 03a\_figures\_impactedonly.R     | 15          | bar\_plot\_impacted.png                  | Annual average PM2.5 by year for impacted monitors                                      |
| Figure 3       | 03a\_figures\_impactedonly.R     | 18          | differences\_bar\_plot\_impacted.png     | Yearly differences in PM2.5 (updated vs original) for impacted monitors                 |
| Figure 4       | 03a\_figures\_impactedonly.R     | 24          | qq\_plot\_impacted.png                   | QQ plot comparing original vs updated PM2.5 distributions                               |
| Figure 5       | 03a\_figures\_impactedonly.R     | 28          | scatter\_plot.png                        | Satellite vs monitor PM2.5 for impacted monitors                                        |
| Figure 6       | 03a\_figures\_impactedonly.R     | 43          | share236or238\_bar\_plot.png             | Share of erroneous monitors (method 236/238) by year                                    |
| Figure 7       | 03b\_figures\_alldata.R          | 12          | density\_plot\_99\_alldata.png           | Distribution of PM2.5 (trimmed at 99th percentile) for all monitors                     |
| Figure 8       | 03b\_figures\_alldata.R          | 15          | bar\_plot\_alldata.png                   | Annual average PM2.5 by year for all monitors                                           |
| Figure 9       | 03b\_figures\_alldata.R          | 18          | differences\_bar\_plot\_alldata.png      | Yearly differences in PM2.5 (updated vs original) for all monitors                      |
| Figure 10      | 03b\_figures\_alldata.R          | 24          | qq\_plot\_alldata.png                    | QQ plot comparing original vs updated PM2.5 for all monitors                            |
| Figure 11      | 03b\_figures\_alldata.R          | 28          | scatter\_plot\_alldata.png               | Satellite vs monitor PM2.5 for all monitors                                             |
| Table 1        | 04a\_regressions\_impactedonly.R | 13          | regression\_results\_table\_impacted.tex | Regression of monitor on satellite PM2.5 (original vs updated data) – impacted monitors |
| Table 2        | 04b\_regressions\_alldata.R      | 13          | regression\_results\_table\_alldata.tex  | Regression of monitor on satellite PM2.5 (original vs updated data) – all monitors      |

## References

US Environmental Protection Agency. Air Quality System Data Mart [internet database] available via https://www.epa.gov/outdoor-air-quality-data. Accessed July 01, 2025.

Aaron van Donkelaar, Melanie S. Hammer, Liam Bindle, Michael Brauer, Jeffery R. Brook, Michael J. Garay, N. Christina Hsu, Olga V. Kalashnikova, Ralph A. Kahn, Colin Lee, Robert C. Levy, Alexei Lyapustin, Andrew M. Sayer and Randall V. Martin (2021). Monthly Global Estimates of Fine Particulate Matter and Their Uncertainty Environmental Science & Technology, 2021, doi:10.1021/acs.est.1c05309. 


